<!-- TODO: TIENE QUE ABRIR MODAL CON EL LIBRO O PÁGINA CON CONTACTO PARA HACER LA TRANSACCIÓN -->

<!-- LOADER -->
<ng-template #other>
	<div class="loader-contenedor">
			<h3> <i class="fa fa-refresh fa-2x fa-spin"></i> </h3>
			<p> Buscando libros... </p>
	</div>
</ng-template>


<!-- ============================================================================== -->
<!-- Card book 																							-->
<!-- ============================================================================== -->
<div class="card-columns" *ngIf="!loading; else other">
	<div class="card" style="width: 18rem;" *ngFor="let book of books; let index = index;">
		<!-- CARROUSEL BOOK IMAGES -->
		<div id="carouselExampleFade-{{index}}" class="carousel slide carousel-fade" data-ride="carousel">
			<div class="carousel-inner">
			  <div class="carousel-item" *ngFor="let img of book.images; let i=index;" [ngClass]="{'active': i===0}" >
				 <img class="d-block img-carousel" [src]="img">
			  </div>
			</div> 
			<a class="carousel-control-prev" href="#carouselExampleFade-{{index}}" role="button" data-slide="prev">
			  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			</a>
			<a class="carousel-control-next" href="#carouselExampleFade-{{index}}" role="button" data-slide="next">
			  <span class="carousel-control-next-icon" aria-hidden="true"></span>
			</a>
		 </div>
		<!-- CARROUSEL BOOK IMAGES -->

		<div class="card-body">
			<h5 class="card-title">Título: {{ book.title | titlecase }}</h5>
			<p class="card-text">Autor/a: {{ book.author | titlecase }}</p>
			<p class="card-text">Editorial: {{book.editorial | titlecase }}</p>
			<p class="card-text">Dueño: {{book.user.name | titlecase }} {{book.user.last_name1 | titlecase }} {{book.user.last_name2 | titlecase }}</p>
			<button class="btn btn-outline-info col-md-6" data-toggle="modal" 
					data-target="#showBook" type="button" (click)="book_modal=book">Ver libro</button>
			<button class="btn btn-outline-info col-md-6" data-toggle="modal" 
					data-target="#contactOwner" type="button" (click)="book_modal=book">Contactar</button>
		</div>
	</div>
</div>

<!-- ====================================================================== -->
<!-- Modal show book														-->
<!-- ====================================================================== -->
<div 	class="modal fade bs-example-modal-lg" 
		tabindex="-1" 
		role="dialog" 
		id="showBook"
		aria-labelledby="myLargeModalLabel" 
		aria-hidden="true" 
		style="display: none;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title" id="myLargeModalLabel"> {{ book_modal.title | titlecase }}</h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<app-one-book [book]="book_modal"></app-one-book>
			</div>
			<!-- ====================================================================== -->
			<!-- Profile collapse														-->
			<!-- ====================================================================== -->
			<div id="accordion">
				<div class="card">
				  	<div class="card-header" id="headingOne">
						<h5 class="mb-0">
					  	<button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
							Ver perfil del dueño
					  	</button>
						</h5>
					</div>
					<div id="collapseOne" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
						<div class="card-body">
							<!-- ====================================================================== -->
							<!-- Show profile															-->
							<!-- ====================================================================== -->
							<div class="col-12">
								<div class="card">
									<div class="card-body row">
										<div class="col-md-6" align="center">
											<img src="../assets/images/profile.jpg" class="img-circle" width="150" /> 
											<h4 class="card-title">
												{{ book_modal.user.name | titlecase }} {{ book_modal.user.last_name1 | titlecase }} {{ book_modal.user.last_name2 | titlecase }} </h4>
											<h6 class="card-subtitle">Accoubts Manager Amix corp</h6>
											<div class="row text-center justify-content-md-center">
												<div class="col-4">
													<a href="javascript:void(0)" class="link">
														<i class="icon-people"></i> 
														<font class="font-medium"> {{ book_modal.user.ranking }} </font>
													</a>
												</div>
												<div class="col-4">
													<a href="javascript:void(0)" class="link">	 
														<i class="icon-picture"></i> 
														<font class="font-medium">54</font>
													</a>
												</div>
											</div>
										</div>
										<div class="col-md-6">
											<small class="text-muted">Correo electrónico</small>
											<h6> {{ book_modal.user.email }} </h6> 
											<small class="text-muted p-t-30 db">Teléfono de contacto</small>
											<h6> {{ book_modal.user.phone }} </h6> 
										</div>
									</div>
									<!-- TODO: Revisar que esté aparezcan todas las cat. Copiar en modal de cardbook -->
									<div class="card-body">
										<small class="text-muted">Categorías favoritas:</small>
										<ul>
											<li>
												<h6>{{ book_modal.user.favs_genres }}</h6>
											</li>
										</ul>
									</div>
									<div class="card-body"> 
										<div class="dropdown-divider"></div>
										<small class="text-muted p-t-30 db">Redes sociales</small><br/>
										<button class="btn btn-circle btn-secondary"><i class="fa fa-facebook"></i></button>
										<button class="btn btn-circle btn-secondary"><i class="fa fa-twitter"></i></button>
										<button class="btn btn-circle btn-secondary"><i class="fa fa-youtube"></i></button>
									</div>
								</div>
							</div>
							<!-- ====================================================================== -->
							<!-- End show profile														-->
							<!-- ====================================================================== -->	
						</div>
					</div>
				</div>
			</div>
			<!-- ====================================================================== -->
			<!-- End profile collapse													-->
			<!-- ====================================================================== -->
			<div class="modal-footer">
				<button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<!-- ====================================================================== -->
<!-- End modal show book													-->
<!-- ====================================================================== -->


<!-- ====================================================================== -->
<!-- Modal contact owner													-->
<!-- ====================================================================== -->
<div 	class="modal fade bs-example-modal-lg" 
		tabindex="-1" 
		role="dialog"
		id="contactOwner" 
		aria-labelledby="myLargeModalLabel" 
		aria-hidden="true" 
		style="display: none;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title" id="myLargeModalLabel"> Contactar dueño/a </h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<!-- Si es solo venta -->
				<div *ngIf="book_modal.transaction == 'Venta'" >
					<label>Elija el mensaje a enviar</label>
					<!-- TODO:  -->
					<!-- TODO: Mostrar preferencias usuario -->
					<select class="form-control" formControlName="text">
						<option value="Deseo establecer la transacción">Deseo establecer la transacción</option>
						<option value="Deseo contactarte personalmente">Deseo contactarte personalmente</option>
						<option value="No me acomodan las preferencias de horario">No me acomodan las preferencias de horario</option>
						<option value="No me acomoda el precio">No me acomoda el precio</option>
					</select>
					<!-- TODO: Botón -->
					<!-- TODO: Mensaje enviado y que se cierre el modal -->
				</div>

				<!-- TODO: Si es intercambio -->

				<!-- TODO: Si son ambas -->



			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<!-- ====================================================================== -->
<!-- End modal contact owner												-->
<!-- ====================================================================== -->
